<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Hello, Bootstrap Table!</title>
        <link rel="stylesheet" href="css/test.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.5/dist/bootstrap-table.min.css">
    </head>
<body>
    
<div class="toolbar p-3">
    <div class="d-flex align-items-center gap-2 button-container">
        <!-- Server Dropdown -->
        <div class="dropdown">
            <button class="btn btn-light dropdown-toggle fixed-width" type="button" id="serverSelect" data-bs-toggle="dropdown" aria-expanded="false">
                Server
            </button>
            <ul class="dropdown-menu" aria-labelledby="serverSelect">
                <li><a class="dropdown-item" href="#" data-value="Europe">Europe</a></li>
                <li><a class="dropdown-item" href="#" data-value="Asia">Asia</a></li>
                <li><a class="dropdown-item" href="#" data-value="Americas">Americas</a></li>
            </ul>
        </div>

        <!-- Tiers Dropdown -->
        <div class="dropdown" id="tierSelect">
            <button class="btn btn-light dropdown-toggle fixed-width" type="button" id="tierDropdownButton" data-bs-auto-close="outside" data-bs-toggle="dropdown" aria-expanded="false">
                Tiers
            </button>
            <ul class="dropdown-menu" aria-labelledby="tierDropdownButton">
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="4" id="tier4" /> <label class="form-check-label" for="tier4">4</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="5" id="tier5" /> <label class="form-check-label" for="tier5">5</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="6" id="tier6" /> <label class="form-check-label" for="tier6">6</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="7" id="tier7" /> <label class="form-check-label" for="tier7">7</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="8" id="tier8" /> <label class="form-check-label" for="tier8">8</label></div></a></li>
            </ul>
        </div>

        <!-- Cities Dropdown -->
        <div class="dropdown" id="citySelect">
            <button class="btn btn-light dropdown-toggle fixed-width" type="button" id="cityDropdownButton" data-bs-auto-close="outside" data-bs-toggle="dropdown" aria-expanded="false">
                Cities
            </button>
            <ul class="dropdown-menu" aria-labelledby="cityDropdownButton">
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Martlock" id="martlock" /> <label class="form-check-label" for="martlock">Martlock</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Fort Sterling" id="fortsterling" /> <label class="form-check-label" for="fortsterling">Fort Sterling</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Thetford" id="thetford" /> <label class="form-check-label" for="thetford">Thetford</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Lymhurst" id="lymhurst" /> <label class="form-check-label" for="lymhurst">Lymhurst</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Bridgewatch" id="bridgewatch" /> <label class="form-check-label" for="bridgewatch">Bridgewatch</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Caerleon" id="caerleon" /> <label class="form-check-label" for="caerleon">Caerleon</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Brecilien" id="brecilien" /> <label class="form-check-label" for="brecilien">Brecilien</label></div></a></li>
                <li><a class="dropdown-item" href="#"><div class="form-check"><input class="form-check-input" type="checkbox" value="Black Market" id="blackmarket" /> <label class="form-check-label" for="blackmarket">Black Market</label></div></a></li>
            </ul>
        </div>

        <!-- Market Age Input -->
        <input type="number" class="form-control fixed-width" id="marketAge" placeholder="Market Age (default 20)" aria-label="Market Age">
        <div class="form-check"><input class="form-check-input" type="checkbox" value="true" id="premium" /> <label class="form-check-label" for="premium">Premium?</label></div>
        <!-- Find Flips Button -->
        <button type="button" onclick="" class="btn btn-primary fixed-width">Find Flips!</button>
    </div>
</div>
  
<table class="table sortable" id="tradesTable" data-toolbar=".toolbar" data-toggle="table" data-sortable="true">
    <thead>
        <tr>
            <th data-field="item" data-sortable="true">Item</th>
            <th data-field="profit" data-sortable="true">Profit</th>
            <th data-visible="true" data-field="tradeRoute" data-sortable="true">Flip!</th>
        </tr>
    </thead>
</table>

<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.5/dist/bootstrap-table.min.js"></script>
<script src="js/test.js" defer></script>
<script>
    $(document).ready(function() {
        // Event listener for dropdown item clicks
        $('.dropdown-menu .dropdown-item').on('click', function() {
            // Get the selected item's text
            var selectedText = $(this).data('value');
            // Update the button text
            $('#serverSelect').text(selectedText);
        });
    });
    document.querySelectorAll('#citySelect .form-check-input').forEach(input => {
        input.addEventListener('change', function() {
            let selectedCities = [];
            document.querySelectorAll('#citySelect .form-check-input:checked').forEach(checked => {
                selectedCities.push(checked.labels[0].textContent);
            });
            document.getElementById('cityDropdownButton').textContent = selectedCities.join(', ') || 'City';
        });
    });

    // Function to update tierSelect dropdown label with selected tiers
    document.querySelectorAll('#tierSelect .form-check-input').forEach(input => {
        input.addEventListener('change', function() {
            let selectedTiers = [];
            document.querySelectorAll('#tierSelect .form-check-input:checked').forEach(checked => {
                selectedTiers.push(checked.labels[0].textContent);
            });
            document.getElementById('tierDropdownButton').textContent = selectedTiers.join(', ') || 'Tiers';
        });
    });
</script>
<script>
    document.querySelector('.btn-primary').addEventListener('click', function(event) {
    event.preventDefault();  // Prevent automatic trigger
    processData();
});
</script>
</body>
<script>
    function processData() {
        var server = document.getElementById('serverSelect').innerText.toLowerCase();
        var marketAge = parseInt(document.getElementById('marketAge').value);
        var selectedTiers = [];
        var selectedCities = [];
        var premium = document.getElementById('premium').checked;
        document.querySelectorAll('#tierSelect .form-check-input:checked').forEach(function(checkbox) {
            selectedTiers.push(parseInt(checkbox.value));  // Collect checked checkbox values
        });
        document.querySelectorAll('#citySelect .form-check-input:checked').forEach(function(checkbox) {
            selectedCities.push(checkbox.value);  // Collect checked checkbox values
        });
        main(server,selectedTiers,selectedCities,marketAge, premium);
    }
</script>
</body>
</html>